(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{388:function(t,s,a){"use strict";a.r(s);var v=a(25),_=Object(v.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前端工程化体系设计与实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端工程化体系设计与实践"}},[t._v("#")]),t._v(" 前端工程化体系设计与实践")]),t._v(" "),a("h2",{attrs:{id:"前端工程简史"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端工程简史"}},[t._v("#")]),t._v(" 前端工程简史")]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("前端技能栈")])])]),t._v(" "),a("ul",[a("li",[t._v("用户体验\n"),a("ul",[a("li",[t._v("性能优化策略")]),t._v(" "),a("li",[t._v("浏览器渲染策略")]),t._v(" "),a("li",[t._v("JavaScript 引擎工作原理")])])]),t._v(" "),a("li",[t._v("应用技能\n"),a("ul",[a("li",[t._v("JavaScript\n"),a("ul",[a("li",[t._v("编程能力")]),t._v(" "),a("li",[t._v("抽象能力")]),t._v(" "),a("li",[t._v("架构能力")])])]),t._v(" "),a("li",[t._v("CSS\n"),a("ul",[a("li",[t._v("综合应用")]),t._v(" "),a("li",[t._v("必要 hack 方案")])])]),t._v(" "),a("li",[t._v("HTML")])])]),t._v(" "),a("li",[t._v("核心技能\n"),a("ul",[a("li",[t._v("数据结构")]),t._v(" "),a("li",[t._v("算法")]),t._v(" "),a("li",[t._v("软件工程")])])]),t._v(" "),a("li",[t._v("Node.js\n"),a("ul",[a("li",[t._v("Web 应用基本架构模型")]),t._v(" "),a("li",[t._v("HTTP 协议")])])])]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("SPA 单页应用")])])]),t._v(" "),a("p",[t._v("优点")]),t._v(" "),a("ul",[a("li",[t._v("减轻了服务器资源消耗")]),t._v(" "),a("li",[t._v("与 HTML 文档比起来，JSON 数据的体积也小很多，减少了网络请求的时间消耗")]),t._v(" "),a("li",[t._v("页面路由控制更加灵活")]),t._v(" "),a("li",[t._v("可以离线使用")])]),t._v(" "),a("p",[t._v("缺点")]),t._v(" "),a("ul",[a("li",[t._v("浏览器需要等待 JavaScript 文件加载完成后才可以渲染后续的 HTML 文档，产生白屏时间。")]),t._v(" "),a("li",[t._v("前后端之间需协调：如 history 路由问题")]),t._v(" "),a("li",[t._v("不利于 SEO 搜索引擎优化")])]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("前后端分离")])])]),t._v(" "),a("ul",[a("li",[t._v("开发\n"),a("ul",[a("li",[t._v("基于 nodejs 中间层，前端 mock 数据")])])]),t._v(" "),a("li",[t._v("测试\n"),a("ul",[a("li",[t._v("前后端测试互不影响，联合测试需要专业测试人员")]),t._v(" "),a("li",[t._v("前端还应该管控生产环境下的质量管控问题，制定客户端监控系统，收集客户端问题并及时预警。")])])]),t._v(" "),a("li",[t._v("部署\n"),a("ul",[a("li",[t._v("方案一：静态资源部署到静态资源文件服务器上，HTML 模版和中间层 Node.js 一起部署到 Web 服务器")]),t._v(" "),a("li",[t._v("方案二：SPA 的理论上可以和静态资源一起部署到静态文件服务器上，但是需要处理 HTML 缓存的问题。如果 HTML 文件被浏览器强制缓存到本地，那么开发人员即使更新了 HTML 文件，也无法获取到最新资源。\n"),a("ul",[a("li",[t._v("解决方案一：分别为 HTML 资源和其它资源分配不同的缓存策略。HTML 资源使用协商缓存（304），其它资源使用强缓存（200 from cache）")]),t._v(" "),a("li",[t._v("解决方案二：所有静态资源都采取协商缓存(不如第一种策略)")])])])])])]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("前端工程化")])])]),t._v(" "),a("blockquote",[a("p",[t._v("前端工程化是一系列工具和规范的组合。")])]),t._v(" "),a("p",[t._v("前端工程化的三个阶段：")]),t._v(" "),a("ol",[a("li",[t._v("本地工具链")]),t._v(" "),a("li",[t._v("管理平台")]),t._v(" "),a("li",[t._v("持续集成")])]),t._v(" "),a("p",[a("strong",[t._v("本地工具链")]),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("开发层面（引入动态构建流程）\n"),a("ul",[a("li",[t._v("ES 规范与浏览器兼容性不一致")]),t._v(" "),a("li",[t._v("CSS 的弱编程能力")]),t._v(" "),a("li",[t._v("资源定位")]),t._v(" "),a("li",[t._v("图片压缩/base64 内嵌/CSS Sprites")]),t._v(" "),a("li",[t._v("模块依赖分析和压缩打包")])])]),t._v(" "),a("li",[t._v("协作层面（mock 服务）\n"),a("ul",[a("li",[t._v("JavaScript 部分逻辑依赖接口 API")])])]),t._v(" "),a("li",[t._v("部署层面（静态资源和动态资源分离部署）\n"),a("ul",[a("li",[t._v("部分资源需要借助后端工程师部署")])])])]),t._v(" "),a("p",[t._v("工程化并不是工具化。其中规范包括")]),t._v(" "),a("ul",[a("li",[t._v("项目文件的组织结构")]),t._v(" "),a("li",[t._v("源代码的开发范式")]),t._v(" "),a("li",[t._v("工具的使用规范，比如 git 分支管理")]),t._v(" "),a("li",[t._v("各阶段环境的依赖。")])]),t._v(" "),a("p",[a("strong",[t._v("管理平台")]),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("淡化环境差异性")]),t._v(" "),a("li",[t._v("权限其中管理，提高安全性")]),t._v(" "),a("li",[t._v("项目版本集中控制，便于危机处理，比如版本回滚等")])]),t._v(" "),a("p",[a("strong",[t._v("持续集成")]),t._v(":")]),t._v(" "),a("p",[t._v("前端工程化只是整个 Web 工作流的一个子集方案。前端工程化必然是整体工作流，和后端服务必然需要配合。")]),t._v(" "),a("h2",{attrs:{id:"脚手架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#脚手架"}},[t._v("#")]),t._v(" 脚手架")]),t._v(" "),a("blockquote",[a("p",[t._v("脚手架的功能是创建项目初始化文件，本质是方案的封装")])]),t._v(" "),a("p",[t._v("优秀的脚手架原则")]),t._v(" "),a("ul",[a("li",[t._v("功能角度\n"),a("ul",[a("li",[t._v("与构建、开发、部署等功能模块联动，在创建项目时生成对应的配置项")]),t._v(" "),a("li",[t._v("自动安装以来模块")])])]),t._v(" "),a("li",[t._v("平台角度\n"),a("ul",[a("li",[t._v("动态可配置")]),t._v(" "),a("li",[t._v("底层高度可扩展")])])]),t._v(" "),a("li",[t._v("易用性角度\n"),a("ul",[a("li",[t._v("丰富但不繁琐的配置")]),t._v(" "),a("li",[t._v("支持多种运行环境")]),t._v(" "),a("li",[t._v("兼容主流操作系统")])])])]),t._v(" "),a("h2",{attrs:{id:"构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[t._v("#")]),t._v(" 构建")]),t._v(" "),a("blockquote",[a("p",[t._v("将源代码转化为宿主浏览器可执行的代码，其核心是资源管理。")])]),t._v(" "),a("p",[t._v("前端的产出资源包括 JS、CSS、HTML 等，分别对应的源代码则是：")]),t._v(" "),a("ul",[a("li",[t._v("浏览器无法兼容的高版本 ECMAScript 规范的 JS 脚本 ---\x3e ECMAScript 规范转义为兼容到浏览器某个版本")]),t._v(" "),a("li",[t._v("LESS/SASS 预编译语法编写的 CSS 文件 ---\x3e CSS 预编译语法转义为普通 CSS 文件")]),t._v(" "),a("li",[t._v("其它模版语法编写的 HTML 代码 ---\x3e HTML 模版解析和渲染")])]),t._v(" "),a("p",[t._v("除了资源本身，构建工具还考虑到 Web 应用的性能和用户体验等因素。")]),t._v(" "),a("ul",[a("li",[t._v("依赖打包：分析文件依赖打包，将同步依赖的文件打包在一起，减少 HTTP 请求数量")]),t._v(" "),a("li",[t._v("资源嵌入：比如小于 10KB 的图片编译为 base64 格式嵌入文档，减少 HTTP 请求")]),t._v(" "),a("li",[t._v("文件压缩：减少文件体积，缩短请求时间")]),t._v(" "),a("li",[t._v("hash 指纹：通过给文件名加入 hash 指纹，应对浏览器缓存问题")])]),t._v(" "),a("p",[t._v("HTML 和 JS、CSS 文件和图片资源等是引用和被引用的关系。被引用资源经过构建后通常有以下改动。")]),t._v(" "),a("ul",[a("li",[t._v("域名/路径改变")]),t._v(" "),a("li",[t._v("文件名改变：加了 hash 指纹等")])]),t._v(" "),a("p",[t._v("所以构建工具还要解决")]),t._v(" "),a("ul",[a("li",[t._v("资源定位")])]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("结合 Webpack 与 Babel 实现 JavaScript 构建")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("babel-preset-dev")])])]),t._v(" "),a("p",[a("code",[t._v("babel-loader")]),t._v("是官方提供的 webpack 插件。典型配置方案：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  module"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/.js$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      exclude"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/(node_modules|browser_components)/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        loader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        options"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          presets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'es2015'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-plugin-transform-object-rest-spread'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("上面的 presets 插件，是一个典型使用 babel 插件编译 ES2015 规范的配置，"),a("code",[t._v("babel-preset-es2015")]),t._v("插件是一个集合，包含了将 ES6 转化为 ES5 的所有语法。而 "),a("code",[t._v("babel-preset-env")]),t._v("插件则是指定需要兼容目标浏览器的版本，就会根据官方的兼容信息组合需要的 babel 插件，并最终将源代码编译为目标浏览器兼容的语法。")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  presets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      targets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chrome"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"modules"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 禁用 babel-preset-env 的模块化规范转化")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 比如AMD，COMMONJS默认转化为COMMONJS")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("p",[t._v("或者是浏览器的最新 2 个版本以及 IE8+")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("targets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browsers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"last 2 versions"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ie>=8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("或者是市场占有份额")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("targets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browsers"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('">= 5%"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v(".babelrc")])])]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("babel-loader")]),t._v("在 webpack 中进行 options 配置有一个缺陷：编译只符合 test 规则的文件。有些特殊业务框架编写的源代码需要将 script 标签内部的代码使用 Vue 编译。需要使用"),a("code",[t._v(".babelrc")]),t._v("编写配置。")]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("CSS 预编译与 PostCSS")])])]),t._v(" "),a("p",[t._v("CSS 预编译器：")]),t._v(" "),a("ol",[a("li",[t._v("增强编程能力")]),t._v(" "),a("li",[t._v("增强源代码可复用性")]),t._v(" "),a("li",[t._v("增强源代码可维护性")]),t._v(" "),a("li",[t._v("便于解决浏览器兼容性")])]),t._v(" "),a("p",[t._v("不同编译器特性不同，但核心目标为以下几点：")]),t._v(" "),a("ul",[a("li",[t._v("嵌套")]),t._v(" "),a("li",[t._v("变量：源码可编程能力")]),t._v(" "),a("li",[t._v("mixin/继承：hack 和代码复用")]),t._v(" "),a("li",[t._v("运算：源码可编程能力")]),t._v(" "),a("li",[t._v("模块化：源码复用和可维护")])]),t._v(" "),a("p",[t._v("PostCSS")]),t._v(" "),a("ul",[a("li",[t._v("PostCSS 主要解决兼容浏览器版本，比如 autoprefix、自动 CSS Sprites 等")]),t._v(" "),a("li",[t._v("CSS 预编译器弥补 CSS 源码的弱编程能力")])]),t._v(" "),a("p",[t._v("👉"),a("strong",[a("mark",[t._v("模块化开发")])])]),t._v(" "),a("p",[t._v("为什么使用模块化开发?")]),t._v(" "),a("ul",[a("li",[t._v("避免命名冲突")]),t._v(" "),a("li",[t._v("便于依赖管理：浏览器解析文件是按照由上到下的顺序解析，两个依赖关系的 JS 必须保证加载顺序。")]),t._v(" "),a("li",[t._v("利于性能优化：配合模块化的按需加载功能更便利。并且构建工具将同步模块进行合并打包，减少客户端请求。treeShaking 减少了冗余代码的数量。")]),t._v(" "),a("li",[t._v("提高可维护性")]),t._v(" "),a("li",[t._v("利于代码复用")])]),t._v(" "),a("p",[t._v("前端模块发展史")]),t._v(" "),a("ol",[a("li",[t._v("CommonJS"),a("br"),t._v("\n被 nodejs 采用为默认模块化规范,并不适合浏览器环境：\n"),a("ul",[a("li",[t._v("浏览器环境的前端资源不仅仅包括 JavaScript，还包括 CSS、图片等。CommonJS 无法处理 JavaScript 以外的资源")]),t._v(" "),a("li",[t._v("CommmonJS 所有模块都采用同步阻塞式加载，无法实现按需异步加载。")])])]),t._v(" "),a("li",[t._v("AMD/CMD"),a("br"),t._v("\n两个规范有所不同，但是核心功能是统一的。在 CommonJS 基础上，AMD/CMD 扩展了以下功能：\n"),a("ul",[a("li",[t._v("可以处理 JavaScript 以外的资源")]),t._v(" "),a("li",[t._v("资源无须编译便可在浏览器下运行")]),t._v(" "),a("li",[t._v("按需异步加载，并行加载")]),t._v(" "),a("li",[t._v("插件系统"),a("br"),t._v("\n但也是一种折中方案：")]),t._v(" "),a("li",[t._v("模块无法跨环境运行")]),t._v(" "),a("li",[t._v("构建工具不统一")]),t._v(" "),a("li",[t._v("不同模块规范之间不可复用")])])]),t._v(" "),a("li",[t._v("ES6 Module"),a("br"),t._v("\nBabel 和 webpack 都已经实现对 import 函数的支持。")])]),t._v(" "),a("p",[t._v("webpack 模块化构建")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("待完善")]),t._v(" "),a("p",[t._v("webpack 对 ES6 Modules 的异步模块支持功能")])])])}),[],!1,null,null,null);s.default=_.exports}}]);